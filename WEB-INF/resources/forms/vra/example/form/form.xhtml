<?xml version="1.0" encoding="UTF-8"?>


<html xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.w3.org/1999/xhtml http://www.w3.org/2002/08/xhtml/xhtml1-transitional.xsd
    http://www.w3.org/2002/xforms  http://www.w3.org/MarkUp/Forms/2002/XForms-Schema.xsd"
    xmlns="http://www.w3.org/1999/xhtml" xmlns:xxi="http://orbeon.org/oxf/xml/xinclude"
    xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:xi="http://www.w3.org/2001/XInclude"
    xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:xhtml="http://www.w3.org/1999/xhtml"
    xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:fr="http://orbeon.org/oxf/xml/form-runner"
    xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:vra="http://www.vraweb.org/vracore4.htm"
    xmlns:xxforms="http://orbeon.org/oxf/xml/xforms" xmlns:uva="http://www.lib.virginia.edu/ole">
    <head>
        <title>VRA Example</title>

        <xi:include href="oxf:/forms/vra/example/xbl/setType.xbl" xxi:omit-xml-base="true"></xi:include>
        <xi:include href="oxf:/forms/vra/example/xbl/basicString.xbl" xxi:omit-xml-base="true"></xi:include>
        
        <xforms:model id="fr-form-model">
            <!-- VRA schema -->
            <xi:include href="oxf:/forms/vra/vra.xsd" xxi:omit-xml-base="true"></xi:include>

            <!-- This is the default basic skeleton for your form. Any nodes you want to be present, or
            default values, add to this xml file. -->
            <xforms:instance id="fr-form-instance" xxforms:validation="strict">
                <xi:include href="oxf:/forms/vra/example/template.xml" xxi:omit-xml-base="true"
                ></xi:include>
            </xforms:instance>


            <!--  Instance to control button triggers -->
            <xforms:instance id="triggers-instance">
                <control xmlns="">
                    <buttons-triggers></buttons-triggers>
                </control>
            </xforms:instance>

            <xforms:bind nodeset="instance('triggers-instance')">
                <xforms:bind id="buttons-triggers"
                    readonly="xxforms:instance('fr-parameters-instance')/mode != 'new' and xxforms:instance('fr-parameters-instance')/mode != 'edit' "
                ></xforms:bind>
            </xforms:bind>

            <!--  Insert Instance -->
            <xforms:instance id="vra-insert" src="oxf:/forms/vra/example/vra-insert.xml"></xforms:instance>

            <!-- Form Binds -->

            <xforms:bind id="fr-form-binds" nodeset="." type="vra:vra">
                <xforms:bind id="image-bind" nodeset="vra:image">
                    <xforms:bind id="identifier-bind" nodeset="@refid" required="true()"></xforms:bind>
                    <xforms:bind id="titleSet-bind" nodeset="vra:titleSet">
                        <!-- <xforms:bind id="title-bind" nodeset="vra:title" required="true()">
                            <xforms:bind id="titletype" nodeset="@type"></xforms:bind>
                        </xforms:bind> -->
                    </xforms:bind>
                    <xforms:bind id="descriptionSet-bind" nodeset="vra:descriptionSet"
                    ></xforms:bind>
                </xforms:bind>
            </xforms:bind>

            <!-- Be sure to put the following AFTER the fr-form-binds section. -->
            <!-- Application Metadata -->
            <xforms:instance id="fr-form-metadata" xxforms:readonly="true">
                <metadata xmlns="">
                    <application-name>vra</application-name>
                    <form-name>example</form-name>
                    <title xml:lang="en">VRA Example</title>
                    <description xml:lang="en">VRA Example</description>
                    <author>ajs6f</author>
                    <logo mediatype="image/png" filename="library_logo_stacked.png"
                        >/forms/library_logo_stacked.png</logo>
                </metadata>
            </xforms:instance>


            <!-- XForms instance containing all the language resources -->
            <!-- This form does not use these values much and instead hardcodes most of 
            the values into the form. However, a few values were added to the resources.xml
            for form running to properly function -->
            <xforms:instance id="fr-form-resources">
                <xi:include href="oxf:/forms/vra/example/form/resources.xml"
                    xxi:omit-xml-base="true"></xi:include>
            </xforms:instance>
        </xforms:model>
        <style type="text/css">
            <!--
            To prevent the first grid to become too tall-->
            #image-output-control.xforms-mediatype-image {
                max-height : 200px
            }
            .fr-mode-view .fr-grid-content {
                padding : 0
            }</style>
    </head>
    <body>
        <fr:view>
            <xforms:label>VRA Example</xforms:label>
            <fr:body>
                <fr:section id="titleSet-section" bind="titleSet-bind">
                    <xforms:label ref="$form-resources/detail/titles/titleSet"></xforms:label>
                    <xforms:help ref="$form-resources/detail/help/titleSet"></xforms:help>
                    <xforms:alert ref="$form-resources/detail/alert/titleSet"></xforms:alert>
                    <uva:setType>
                        <xforms:group appearance="xxforms:table">
                            <fr:repeat nodeset="vra:title" id="title-repeat"
                                origin="xxforms:instance('vra-insert')/insert[@name = 'title']/vra:title">
                                <fr:body>
                                    <fr:tr>
                                        <fr:td>
                                            <xforms:input incremental="true" ref="."
                                                appearance="xxforms:autosize">
                                                <xforms:label
                                                  ref="$form-resources/detail/titles/title"></xforms:label>
                                                <xforms:help ref="$form-resources/detail/help/title"></xforms:help>
                                                <xforms:alert
                                                  ref="$form-resources/detail/alerts/title"
                                                ></xforms:alert>
                                            </xforms:input>
                                        </fr:td>
                                        <fr:td>
                                            <xforms:input ref="@type">
                                                <xforms:label
                                                  ref="$form-resources/detail/titles/titletype"></xforms:label>
                                                <xforms:alert
                                                  ref="$form-resources/detail/alerts/titletype"></xforms:alert>
                                                <xforms:help
                                                  ref="$form-resources/detail/help/titletype"
                                                ></xforms:help>
                                            </xforms:input>
                                        </fr:td>
                                        <div class="repeat-border"></div>
                                    </fr:tr>
                                </fr:body>
                            </fr:repeat>
                        </xforms:group>
                    </uva:setType>
                </fr:section>
                <fr:section id="descriptionSet-section" bind="descriptionSet-bind">
                    <xforms:label ref="$form-resources/detail/titles/descriptionSet"></xforms:label>
                    <xforms:help ref="$form-resources/detail/help/descriptionSet"></xforms:help>
                    <xforms:alert ref="$form-resources/detail/alert/descriptionSet"></xforms:alert>
                    <uva:setType>
                        <xforms:group appearance="xxforms:table">
                            <fr:tr>
                                <fr:td>
                                    <uva:basicString ref="vra:description">
                                        <xforms:label>Description</xforms:label>
                                    </uva:basicString>
                                </fr:td>
                            </fr:tr>
                        </xforms:group>
                    </uva:setType>
                </fr:section>
            </fr:body>
        </fr:view>
    </body>
</html>
